import{g as ge,r as ie,x as v,M as xe,P as fe,G as ye,j as S,v as Ce,at as ke,au as Pe,av as Ve,aw as we,ax as Fe,ay as _e,az as ne,ao as Se,aA as De,L as ze,_ as Ie,c as q,o as h,w as n,a as i,Q as M,e as D,b as o,f as P,aq as z,d as F,a5 as V,a6 as J,a7 as Z,a8 as Ne,t as y,Z as I,a1 as ee,aB as se,h as te,a4 as ue,as as Ee,aC as de}from"./index-CkwW658k.js";import{Q as Ue}from"./QPagination-BXXORRb3.js";import{d as Qe,Q as ae,a as N,b as le}from"./QMenu-BxSGVo63.js";import{Q as qe}from"./QList-DWftO5sk.js";import{Q as Ae,C as H}from"./ClosePopup-St8FszOw.js";import{Q as ce}from"./QImg-DTEDvONU.js";import{Q as me}from"./QMarkupTable-DjcI4_U-.js";import{Q as pe}from"./QSpace-B9p6B1Z2.js";import{h as Ge}from"./format-CJebrXOQ.js";import{Q as je}from"./QForm-ncJ53PkC.js";import{Q as Be}from"./QPage-B6yhDjV_.js";import"./moment-C5S46NFB.js";import{E as Te}from"./Excel-DYSTQ5HC.js";import"./_commonjsHelpers-Bx2EM-6T.js";function E(e,t,p,_){const l=[];return e.forEach(s=>{_(s)===!0?l.push(s):t.push({failedPropValidation:p,file:s})}),l}function R(e){e?.dataTransfer&&(e.dataTransfer.dropEffect="copy"),fe(e)}const Oe={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Le=["rejected"];function Me({editable:e,dnd:t,getFileInput:p,addFilesToQueue:_}){const{props:l,emit:s,proxy:a}=ge(),g=ie(null),A=v(()=>l.accept!==void 0?l.accept.split(",").map(r=>(r=r.trim(),r==="*"?"*/":(r.endsWith("/*")&&(r=r.slice(0,r.length-1)),r.toUpperCase()))):null),G=v(()=>parseInt(l.maxFiles,10)),j=v(()=>parseInt(l.maxTotalSize,10));function B(r){if(e.value)if(r!==Object(r)&&(r={target:null}),r.target?.matches('input[type="file"]')===!0)r.clientX===0&&r.clientY===0&&xe(r);else{const C=p();C!==r.target&&C?.click(r)}}function T(r){e.value&&r&&_(null,r)}function K(r,C,U,Q){let d=Array.from(C||r.target.files);const x=[],w=()=>{x.length!==0&&s("rejected",x)};if(l.accept!==void 0&&A.value.indexOf("*/")===-1&&(d=E(d,x,"accept",c=>A.value.some(f=>c.type.toUpperCase().startsWith(f)||c.name.toUpperCase().endsWith(f))),d.length===0))return w();if(l.maxFileSize!==void 0){const c=parseInt(l.maxFileSize,10);if(d=E(d,x,"max-file-size",f=>f.size<=c),d.length===0)return w()}if(l.multiple!==!0&&d.length!==0&&(d=[d[0]]),d.forEach(c=>{c.__key=c.webkitRelativePath+c.lastModified+c.name+c.size}),Q===!0){const c=U.map(f=>f.__key);d=E(d,x,"duplicate",f=>c.includes(f.__key)===!1)}if(d.length===0)return w();if(l.maxTotalSize!==void 0){let c=Q===!0?U.reduce((f,X)=>f+X.size,0):0;if(d=E(d,x,"max-total-size",f=>(c+=f.size,c<=j.value)),d.length===0)return w()}if(typeof l.filter=="function"){const c=l.filter(d);d=E(d,x,"filter",f=>c.includes(f))}if(l.maxFiles!==void 0){let c=Q===!0?U.length:0;if(d=E(d,x,"max-files",()=>(c++,c<=G.value)),d.length===0)return w()}if(w(),d.length!==0)return d}function W(r){R(r),t.value!==!0&&(t.value=!0)}function m(r){fe(r),(r.relatedTarget!==null||ye.is.safari!==!0?r.relatedTarget!==g.value:document.elementsFromPoint(r.clientX,r.clientY).includes(g.value)===!1)===!0&&(t.value=!1)}function O(r){R(r);const C=r.dataTransfer.files;C.length!==0&&_(null,C),t.value=!1}function $(r){if(t.value===!0)return S("div",{ref:g,class:`q-${r}__dnd absolute-full`,onDragenter:R,onDragover:R,onDragleave:m,onDrop:O})}return Object.assign(a,{pickFiles:B,addFiles:T}),{pickFiles:B,addFiles:T,onDragover:W,onDragleave:m,processFiles:K,getDndNode:$,maxFilesNumber:G,maxTotalSizeNumber:j}}const He=Ce({name:"QFile",inheritAttrs:!1,props:{...Ve,...Pe,...Oe,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ke,...Le],setup(e,{slots:t,emit:p,attrs:_}){const{proxy:l}=ge(),s=we(),a=ie(null),g=ie(!1),A=Fe(e),{pickFiles:G,onDragover:j,onDragleave:B,processFiles:T,getDndNode:K}=Me({editable:s.editable,dnd:g,getFileInput:oe,addFilesToQueue:re}),W=_e(e),m=v(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),O=v(()=>ne(m.value)),$=v(()=>m.value.map(u=>u.name).join(", ")),r=v(()=>Ge(m.value.reduce((u,b)=>u+b.size,0))),C=v(()=>({totalSize:r.value,filesNumber:m.value.length,maxFiles:e.maxFiles})),U=v(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:A.value,..._,id:s.targetUid.value,disabled:s.editable.value!==!0})),Q=v(()=>"q-file q-field--auto-height"+(g.value===!0?" q-file--dnd":"")),d=v(()=>e.multiple===!0&&e.append===!0);function x(u){const b=m.value.slice();b.splice(u,1),c(b)}function w(u){const b=m.value.indexOf(u);b!==-1&&x(b)}function c(u){p("update:modelValue",e.multiple===!0?u:u[0])}function f(u){u.keyCode===13&&ze(u)}function X(u){(u.keyCode===13||u.keyCode===32)&&G(u)}function oe(){return a.value}function re(u,b){const k=T(u,b,m.value,d.value),Y=oe();Y!=null&&(Y.value=""),k!==void 0&&((e.multiple===!0?e.modelValue&&k.every(ve=>m.value.includes(ve)):e.modelValue===k[0])||c(d.value===!0?m.value.concat(k):k))}function L(){return[S("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function he(){if(t.file!==void 0)return m.value.length===0?L():m.value.map((b,k)=>t.file({index:k,file:b,ref:this}));if(t.selected!==void 0)return m.value.length===0?L():t.selected({files:m.value,ref:this});if(e.useChips===!0)return m.value.length===0?L():m.value.map((b,k)=>S(Qe,{key:"file-"+k,removable:s.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{x(k)}},()=>S("span",{class:"ellipsis",textContent:b.name})));const u=e.displayValue!==void 0?e.displayValue:$.value;return u.length!==0?[S("div",{class:e.inputClass,style:e.inputStyle,textContent:u})]:L()}function be(){const u={ref:a,...U.value,...W.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:re};return e.multiple===!0&&(u.multiple=!0),S("input",u)}return Object.assign(s,{fieldClass:Q,emitValue:c,hasValue:O,inputRef:a,innerValue:m,floatingLabel:v(()=>O.value===!0||ne(e.displayValue)),computedCounter:v(()=>{if(e.counterLabel!==void 0)return e.counterLabel(C.value);const u=e.maxFiles;return`${m.value.length}${u!==void 0?" / "+u:""} (${r.value})`}),getControlChild:()=>K("file"),getControl:()=>{const u={ref:s.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return s.editable.value===!0&&Object.assign(u,{onDragover:j,onDragleave:B,onKeydown:f,onKeyup:X}),S("div",u,[be()].concat(he()))}}),Object.assign(l,{removeAtIndex:x,removeFile:w,getNativeElement:()=>a.value}),Se(l,"nativeEl",()=>a.value),De(s)}}),Re={name:"ProductosPage",data(){return{productos:[],producto:{},productoDialog:!1,loading:!1,actionPeriodo:"",filter:"",imagenFile:null,imagenPreview:null,pagination:{page:1,rowsPerPage:15,rowsNumber:0},columns:[{name:"nombre",label:"Nombre",align:"left",field:"nombre"},{name:"precio",label:"Precio",align:"left",field:"precio"},{name:"barra",label:"Código de barras",align:"left",field:"barra"},{name:"stock",label:"Stock",align:"left",field:"stock"}],historialDialog:!1,historialCompras:[],productoHistorialNombre:"",imagenDialog:!1,imagenAmpliadaUrl:"",imagenError:!1}},mounted(){this.productosGet(),this.debouncedCambioPrecio=de(this.cambioPrecio,500),this.debouncedCambioBarra=de(this.cambioBarra,500)},methods:{getImagenUrl(e){return`${this.$url}../images/${e}`},verImagenAmpliada(e){this.imagenAmpliadaUrl=this.getImagenUrl(e),this.imagenError=!1,this.imagenDialog=!0},cargarImagenPreview(e){if(e){const t=new FileReader;t.onload=p=>{this.imagenPreview=p.target.result},t.readAsDataURL(e)}else this.imagenPreview=null},eliminarImagenPreview(){this.imagenFile=null,this.imagenPreview=null,this.producto.id&&this.producto.imagen&&(this.producto.eliminarImagen=!0)},cerrarDialogo(){this.productoDialog=!1,this.producto={},this.imagenFile=null,this.imagenPreview=null,this.producto.eliminarImagen&&delete this.producto.eliminarImagen},cambioStockA(e){this.loading=!0,this.$axios.put("productos/"+e.id,{stockAlmacen:e.stockAlmacen}).then(t=>{this.productosGet(),this.$alert.success("Cantidad Almacen actualizada")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},cambioStock1(e){this.loading=!0,this.$axios.put("productos/"+e.id,{stockChallgua:e.stockChallgua}).then(t=>{this.productosGet(),this.$alert.success("Cantidad Sucursal 1 actualizada")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},cambioStock2(e){this.loading=!0,this.$axios.put("productos/"+e.id,{stockSocavon:e.stockSocavon}).then(t=>{this.productosGet(),this.$alert.success("Cantidad Sucursal 2 actualizada")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},cambioStock3(e){this.loading=!0,this.$axios.put("productos/"+e.id,{stockCatalina:e.stockCatalina}).then(t=>{this.productosGet(),this.$alert.success("Cantidad Sucursal 3 actualizada")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},verHistorial(e){this.loading=!0,this.productoHistorialNombre=e.nombre,this.$axios.get(`productos/${e.id}/historial-compras`).then(t=>{this.historialCompras=t.data,this.historialDialog=!0}).catch(t=>{this.$alert.error("Error al obtener historial")}).finally(()=>{this.loading=!1})},cambioBarra(e){this.loading=!0,this.$axios.put("productos/"+e.id,{barra:e.barra}).then(t=>{this.productosGet(),this.$alert.success("Código de barras actualizado")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},cambioStock(e){this.loading=!0,this.$axios.put("productos/"+e.id,{stock:e.stock}).then(t=>{this.productosGet(),this.$alert.success("Stock actualizado")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},cambioPrecio(e){this.loading=!0,this.$axios.put("productos/"+e.id,{precio:e.precio}).then(t=>{this.productosGet(),this.$alert.success("Precio actualizado")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})},exportExcel(){this.loading=!0,this.$axios.get("productosAll").then(e=>{let t=[{columns:[{label:"Nombre",value:"nombre"},{label:"Descripción",value:"descripcion"},{label:"Unidad",value:"unidad"},{label:"Precio",value:"precio"},{label:"Stock",value:"stock"},{label:"Stock mínimo",value:"stock_minimo"},{label:"Stock máximo",value:"stock_maximo"},{label:"Código de barras",value:"barra"},{label:"Imagen",value:"imagen"}],content:e.data}];Te.export(t,"Productos")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},productoNew(){this.producto={nombre:"",descripcion:"",unidad:"",precio:0,barra:"",imagen:null},this.actionPeriodo="Nuevo",this.imagenFile=null,this.imagenPreview=null,this.productoDialog=!0},productosGet(){this.loading=!0,this.$axios.get("productos",{params:{search:this.filter,page:this.pagination.page,per_page:this.pagination.rowsPerPage}}).then(e=>{this.productos=e.data.data,this.pagination.rowsNumber=e.data.total}).catch(e=>{this.$alert.error(e.response?.data?.message||"Error al cargar productos")}).finally(()=>{this.loading=!1})},gestionGet(){this.loading=!0,this.$axios.get("gestiones").then(e=>{this.gestiones=e.data,this.loading=!1}).catch(e=>{this.$alert.error(e.response.data.message),this.loading=!1})},async productoPost(){this.loading=!0;const e=new FormData;Object.keys(this.producto).forEach(t=>{this.producto[t]!==null&&this.producto[t]!==void 0&&e.append(t,this.producto[t])}),this.imagenFile&&e.append("imagen",this.imagenFile);try{const t=await this.$axios.post("productos",e,{headers:{"Content-Type":"multipart/form-data"}});this.productosGet(),this.$alert.success("Producto creado"),this.cerrarDialogo()}catch(t){this.$alert.error(t.response?.data?.message||"Error al crear producto")}finally{this.loading=!1}},async productoPut(){this.loading=!0;const e=new FormData;if(["nombre","descripcion","unidad","precio","barra"].forEach(p=>{this.producto[p]!==null&&this.producto[p]!==void 0&&e.append(p,this.producto[p])}),this.imagenFile&&e.append("imagen",this.imagenFile),this.producto.eliminarImagen)try{await this.$axios.delete(`productos/${this.producto.id}/imagen`)}catch(p){console.error("Error al eliminar imagen:",p)}try{const p=await this.$axios.post(`productos/${this.producto.id}`,e,{headers:{"Content-Type":"multipart/form-data"}});this.productosGet(),this.$alert.success("Producto actualizado"),this.cerrarDialogo()}catch(p){this.$alert.error(p.response?.data?.message||"Error al actualizar producto")}finally{this.loading=!1}},productoEdit(e){this.producto={...e},this.actionPeriodo="Editar",this.imagenFile=null,this.imagenPreview=e.imagen?this.getImagenUrl(e.imagen):null,this.productoDialog=!0},productoDelete(e){this.$alert.dialog("¿Desea eliminar el producto? Esta acción también eliminará la imagen asociada.").onOk(()=>{this.loading=!0,this.$axios.delete("productos/"+e).then(t=>{this.productosGet(),this.$alert.success("Producto eliminado")}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})})}}},Ke={class:"text-right"},We={class:"flex flex-center"},$e={class:"text-center"},Xe={class:"absolute-full flex flex-center bg-grey-3 text-grey-8"},Ye={key:1,class:"text-grey-6"},Je={style:{"max-width":"150px","wrap-option":"wrap","line-height":"0.9"}},Ze=["onUpdate:modelValue","onKeyup"],et=["onUpdate:modelValue","onKeyup"],tt={class:"text-h6"},at={class:"text-center q-mb-md"},lt={key:0,class:"q-mb-sm"},it={class:"row q-gutter-md"},ot={class:"text-right q-pt-md"},rt={class:"text-h6"},nt=["src"],st={key:0,class:"text-center q-pa-lg"};function ut(e,t,p,_,l,s){return h(),q(Be,{class:"q-pa-xs"},{default:n(()=>[i(M,{flat:"",bordered:""},{default:n(()=>[i(D,{class:"q-pa-xs"},{default:n(()=>[o("div",Ke,[o("div",null,[i(P,{color:"primary",label:"Actualizar","no-caps":"",icon:"refresh",loading:l.loading,onClick:s.productosGet},null,8,["loading","onClick"]),i(P,{color:"primary",label:"Descargar","no-caps":"",icon:"fa-solid fa-file-excel",loading:l.loading,onClick:s.exportExcel},null,8,["loading","onClick"]),i(P,{color:"green",label:"Nuevo",onClick:s.productoNew,"no-caps":"",icon:"add_circle_outline",loading:l.loading},null,8,["onClick","loading"])]),i(z,{modelValue:l.filter,"onUpdate:modelValue":[t[0]||(t[0]=a=>l.filter=a),s.productosGet],label:"Buscar",dense:"",outlined:"",debounce:"300"},{append:n(()=>[i(F,{name:"search"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),o("div",We,[i(Ue,{modelValue:l.pagination.page,"onUpdate:modelValue":[t[1]||(t[1]=a=>l.pagination.page=a),s.productosGet],max:Math.ceil(l.pagination.rowsNumber/l.pagination.rowsPerPage),"rows-per-page-options":[10,25,50,100],"rows-per-page":l.pagination.rowsPerPage,"rows-number":l.pagination.rowsNumber,color:"primary","boundary-numbers":"","max-pages":"5"},null,8,["modelValue","max","rows-per-page","rows-number","onUpdate:modelValue"])]),i(me,{dense:"","wrap-cells":""},{default:n(()=>[o("thead",null,[o("tr",null,[t[14]||(t[14]=o("th",null,"Opciones",-1)),t[15]||(t[15]=o("th",null,"Imagen",-1)),(h(!0),V(J,null,Z(l.columns,a=>(h(),V("th",{key:a.name,class:Ne(a.align)},y(a.label),3))),128))])]),o("tbody",null,[(h(!0),V(J,null,Z(l.productos,a=>(h(),V("tr",{key:a.id},[o("td",null,[i(Ae,{label:"Opciones","no-caps":"",size:"10px",dense:"",color:"primary"},{default:n(()=>[i(qe,null,{default:n(()=>[I((h(),q(ae,{clickable:"",onClick:g=>s.productoEdit(a)},{default:n(()=>[i(N,{avatar:""},{default:n(()=>[i(F,{name:"edit"})]),_:1}),i(N,null,{default:n(()=>[i(le,null,{default:n(()=>t[16]||(t[16]=[ee("Editar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[H]]),I((h(),q(ae,{clickable:"",onClick:g=>s.productoDelete(a.id)},{default:n(()=>[i(N,{avatar:""},{default:n(()=>[i(F,{name:"delete"})]),_:1}),i(N,null,{default:n(()=>[i(le,null,{default:n(()=>t[17]||(t[17]=[ee("Eliminar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[H]]),I((h(),q(ae,{clickable:"",onClick:g=>s.verHistorial(a)},{default:n(()=>[i(N,{avatar:""},{default:n(()=>[i(F,{name:"history"})]),_:1}),i(N,null,{default:n(()=>[i(le,null,{default:n(()=>t[18]||(t[18]=[ee("Historial de compras")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[H]])]),_:2},1024)]),_:2},1024)]),o("td",null,[o("div",$e,[a.imagen?(h(),q(ce,{key:0,src:s.getImagenUrl(a.imagen),style:{width:"60px",height:"60px","border-radius":"4px",cursor:"pointer"},class:"q-mr-sm",onClick:g=>s.verImagenAmpliada(a.imagen)},{error:n(()=>[o("div",Xe,[i(F,{name:"image",size:"24px"})])]),_:2},1032,["src","onClick"])):(h(),V("div",Ye,[i(F,{name:"image",size:"24px"}),t[19]||(t[19]=o("div",{class:"text-caption"},"Sin imagen",-1))]))])]),o("td",null,[o("div",Je,y(a.nombre),1)]),o("td",null,[I(o("input",{"onUpdate:modelValue":g=>a.precio=g,type:"number",step:"0.01",min:"0",style:{width:"55px","text-align":"right"},onKeyup:g=>e.debouncedCambioPrecio(a)},null,40,Ze),[[se,a.precio,void 0,{number:!0}]])]),o("td",null,[I(o("input",{"onUpdate:modelValue":g=>a.barra=g,style:{width:"150px","text-align":"right"},onKeyup:g=>e.debouncedCambioBarra(a)},null,40,et),[[se,a.barra,void 0,{number:!0}]])]),o("td",null,y(a.stock_disponible),1)]))),128))])]),_:1})]),_:1})]),_:1}),i(te,{modelValue:l.productoDialog,"onUpdate:modelValue":t[9]||(t[9]=a=>l.productoDialog=a),persistent:""},{default:n(()=>[i(M,{style:{width:"500px",margin:"0 auto"}},{default:n(()=>[i(D,{class:"q-pb-none row items-center"},{default:n(()=>[o("div",tt,y(l.actionPeriodo)+" producto ",1),i(pe),i(P,{icon:"close",flat:"",round:"",dense:"",onClick:s.cerrarDialogo},null,8,["onClick"])]),_:1}),i(D,{class:"q-pt-none"},{default:n(()=>[i(je,{onSubmit:t[8]||(t[8]=a=>l.producto.id?s.productoPut():s.productoPost()),class:"q-gutter-md"},{default:n(()=>[o("div",at,[l.imagenPreview?(h(),V("div",lt,[i(ce,{src:l.imagenPreview,style:{"max-width":"200px","max-height":"200px","border-radius":"8px"},class:"q-mb-sm"},null,8,["src"]),i(P,{icon:"delete",color:"negative",size:"sm",round:"",dense:"",onClick:s.eliminarImagenPreview},null,8,["onClick"])])):ue("",!0),i(He,{modelValue:l.imagenFile,"onUpdate:modelValue":[t[2]||(t[2]=a=>l.imagenFile=a),s.cargarImagenPreview],label:"Subir imagen",accept:".jpg,.jpeg,.png,.gif,.webp","max-files":"1",outlined:"",dense:"",class:"full-width"},{prepend:n(()=>[i(F,{name:"attach_file"})]),_:1},8,["modelValue","onUpdate:modelValue"]),t[20]||(t[20]=o("div",{class:"text-caption text-grey"}," Formatos: JPG, PNG, GIF, WEBP. Máx: 2MB ",-1))]),i(z,{modelValue:l.producto.nombre,"onUpdate:modelValue":t[3]||(t[3]=a=>l.producto.nombre=a),label:"Nombre *",dense:"",outlined:"",rules:[a=>!!a||"Campo requerido"]},null,8,["modelValue","rules"]),i(z,{modelValue:l.producto.descripcion,"onUpdate:modelValue":t[4]||(t[4]=a=>l.producto.descripcion=a),label:"Descripción",dense:"",outlined:"",type:"textarea",rows:"2"},null,8,["modelValue"]),o("div",it,[i(z,{modelValue:l.producto.unidad,"onUpdate:modelValue":t[5]||(t[5]=a=>l.producto.unidad=a),label:"Unidad",dense:"",outlined:"",class:"col",required:""},null,8,["modelValue"]),i(z,{modelValue:l.producto.precio,"onUpdate:modelValue":t[6]||(t[6]=a=>l.producto.precio=a),label:"Precio *",dense:"",outlined:"",type:"number",step:"0.01",min:"0",rules:[a=>a>=0||"Precio debe ser positivo"],class:"col"},null,8,["modelValue","rules"])]),i(z,{modelValue:l.producto.barra,"onUpdate:modelValue":t[7]||(t[7]=a=>l.producto.barra=a),label:"Código de barras",dense:"",outlined:""},null,8,["modelValue"]),o("div",ot,[i(P,{color:"negative",label:"Cancelar",onClick:s.cerrarDialogo,"no-caps":"",loading:l.loading},null,8,["onClick","loading"]),i(P,{color:"primary",label:"Guardar",type:"submit","no-caps":"",loading:l.loading,class:"q-ml-sm"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(te,{modelValue:l.historialDialog,"onUpdate:modelValue":t[11]||(t[11]=a=>l.historialDialog=a),persistent:""},{default:n(()=>[i(M,{style:{width:"800px"}},{default:n(()=>[i(D,{class:"row items-center q-pb-none"},{default:n(()=>[o("div",rt,"Historial de Compras: "+y(l.productoHistorialNombre),1),i(pe),i(P,{icon:"close",flat:"",round:"",dense:"",onClick:t[10]||(t[10]=a=>l.historialDialog=!1)})]),_:1}),i(D,{class:"q-pt-none"},{default:n(()=>[i(me,{dense:"","wrap-cells":"",flat:"",bordered:""},{default:n(()=>[t[21]||(t[21]=o("thead",null,[o("tr",null,[o("th",null,"#"),o("th",null,"Fecha"),o("th",null,"Lote"),o("th",null,"Vencimiento"),o("th",null,"Cantidad"),o("th",null,"Precio"),o("th",null,"Total")])],-1)),o("tbody",null,[(h(!0),V(J,null,Z(l.historialCompras,(a,g)=>(h(),V("tr",{key:a.id},[o("td",null,y(g+1),1),o("td",null,y(a.compra?.fecha),1),o("td",null,y(a.lote),1),o("td",null,y(a.fecha_vencimiento),1),o("td",null,y(a.stock),1),o("td",null,y(a.precio),1),o("td",null,y(a.total),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(te,{modelValue:l.imagenDialog,"onUpdate:modelValue":t[13]||(t[13]=a=>l.imagenDialog=a),maximized:""},{default:n(()=>[i(M,{class:"bg-transparent"},{default:n(()=>[i(Ee,{align:"right"},{default:n(()=>[I(i(P,{icon:"close",flat:"",round:"",dense:""},null,512),[[H]])]),_:1}),i(D,{class:"flex flex-center"},{default:n(()=>[o("img",{src:l.imagenAmpliadaUrl,style:{"max-width":"90vw","max-height":"90vh","object-fit":"contain"},onError:t[12]||(t[12]=a=>l.imagenError=!0)},null,40,nt),l.imagenError?(h(),V("div",st,[i(F,{name:"error",size:"48px",color:"negative"}),t[22]||(t[22]=o("div",{class:"text-h6 q-mt-md"},"Error al cargar la imagen",-1))])):ue("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const Vt=Ie(Re,[["render",ut]]);export{Vt as default};
